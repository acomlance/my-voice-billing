# Archive: Reflect+Archive

**Completed:** 2025-03-01

## Содержимое tasks.md на момент архивации

### Баланс и история списаний (отложено)

**Проблема:** accounts.balance при потере/искажении не восстанавливается — нет истории списаний. Нельзя раздувать tasks (таски удаляем) и transactions (много мелких списаний).

**Варианты решения:**
1. Батчинг списаний — накапливать closed_tokens, периодически писать одну транзакцию-батч на аккаунт.
2. Две таблицы — transaction_charges (мелкие, партиции по дате, purge) + transactions (пополнения, батчи).
3. Снапшоты баланса — balance_snapshots + дельты между ними.
4. charge_aggregates — одна строка на аккаунт за период (день/час), transactions только для пополнений/возвратов.

Вернуться к реализации позже.

## Результат

- Рефлексия: reflection/reflection-20250301.md.
- Архив: archive/archive-20250301.md.
- tasks.md очищен.
