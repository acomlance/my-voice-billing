# Archive: Reflect+Archive (повторная)

**Completed:** 2025-03-01

## Содержимое tasks.md

Пуст.

## Изменения, зафиксированные при архивации

- transaction_repo.Update: balance по old.AccountId, old.Tokens; date_approved при переходе в approved, date_cancelled при переходе в cancelled.
- transaction_logic.Update: вызов только repo.Update.
- task_repo.CreateWithReserveUpdate: SELECT accounts FOR UPDATE перед SUM.
- constants: TxStatusRefunded удалён; PaymentTypeBonus = 3.
- sql/docker-init/03_transactions.sql: status in (0,1,2,3), payment_type in (0,1,2,3).
- proto/billing.proto: справочник статусов (0–3), PaymentType + BONUS.
